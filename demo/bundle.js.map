{"version":3,"file":"bundle.js","sources":["../dist/es6/index.js","src/demo.ts"],"sourcesContent":["import { createClass as _createClass, classCallCheck as _classCallCheck, defineProperty as _defineProperty } from './_virtual/_rollupPluginBabelHelpers.js';\n\n/**\n * Scroll in viewport add data attribute\n * スクロールしてビューポートに入ったらdata属性を与える\n *\n * @author   Hiroshi Fukuda <info.sygnas@gmail.com>\n * @license  MIT\n */\nvar ATTR_INVIEW = 'data-inview';\nvar ATTR_ROOT = 'data-inview-root';\nvar ATTR_MARGIN = 'data-inview-rootMargin';\nvar ATTR_THRESHOLD = 'data-inview-threshold';\nvar DEFAULT = {\n  root: null,\n  rootMargin: '0px',\n  threshold: 0\n};\n/**\n * in view controller\n */\n\nvar _default = /*#__PURE__*/function () {\n  /**\n   * コンストラクタ\n   * ターゲット一覧を精査して、 data-inview-root、data-inview-rootMargin、data-inview-threshold が設定されていないか確認する。\n   * 上記属性毎に observer を作成する。\n   */\n  function _default(target) {\n    var _this = this;\n\n    var option = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, _default);\n\n    _defineProperty(this, \"targetList\", void 0);\n\n    _defineProperty(this, \"opt\", void 0);\n\n    this.targetList = {};\n    this.opt = Object.assign(DEFAULT, option);\n    document.querySelectorAll(target).forEach(function (target) {\n      _this.initTargetList(target);\n    });\n  }\n  /**\n   * ターゲットとオプションの管理リストを作成\n   */\n\n\n  _createClass(_default, [{\n    key: \"initTargetList\",\n    value: function initTargetList(target) {\n      // 監視対象エレメントに独自指定があればそちらを使う。\n      // 無ければオプション設定を使う\n      var root = target.getAttribute(ATTR_ROOT) || this.opt.root;\n      var rootMargin = target.getAttribute(ATTR_MARGIN) || this.opt.rootMargin;\n      var threshold = Number(target.getAttribute(ATTR_THRESHOLD)) || this.opt.threshold;\n      var key = \"\".concat(root, \"-\").concat(rootMargin, \"-\").concat(threshold);\n\n      if (key in this.targetList === false) {\n        var option = {\n          root: root,\n          rootMargin: rootMargin,\n          threshold: threshold\n        };\n        var observer = new IntersectionObserver(this.observerCallback, option);\n        this.targetList[key] = {\n          list: [],\n          observer: observer\n        };\n      }\n\n      this.targetList[key].list.push(target);\n    }\n    /**\n     * スクロール検知処理を開始\n     */\n\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this2 = this;\n\n      Object.keys(this.targetList).forEach(function (key) {\n        var targetObj = _this2.targetList[key];\n        targetObj.list.forEach(function (target) {\n          targetObj.observer.observe(target);\n        });\n      });\n    }\n    /**\n     * 画面に入ったら ATTR_INVIEW のdata属性に true を入れる。\n     * オブザーバーから監視解除される。\n     */\n\n  }, {\n    key: \"observerCallback\",\n    value: function observerCallback(entries, observer) {\n      entries.forEach(function (entry) {\n        if (!entry.isIntersecting) return;\n        observer.unobserve(entry.target);\n        entry.target.setAttribute(ATTR_INVIEW, 'true');\n      });\n    }\n  }]);\n\n  return _default;\n}();\n\nexport { _default as default };\n//# sourceMappingURL=index.js.map\n",null],"names":["ATTR_INVIEW","ATTR_ROOT","ATTR_MARGIN","ATTR_THRESHOLD","DEFAULT","root","rootMargin","threshold","option","Object","document","target","Number","key","observer","list","targetObj","entries","entry","inview","InView","start"],"mappings":"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"}